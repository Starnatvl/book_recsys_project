# Прототип рекомендательной системы книг (Goodbooks-10k)

Этот репозиторий содержит решение двух этапов проекта по построению рекомендательной системы для сервиса чтения книг. Проект демонстрирует эволюцию от классических методов (EDA, SVD, Content-Based) до гибридной системы с использованием нейросетей (NCF).

## Структура решения

### Часть 1: Базовый анализ и классические модели (HW1)
*Файл: `notebooks/01_Basic_Models_EDA.ipynb`*

**Логика решения:**
На первом этапе главной целью было исследование данных и построение бейзлайнов (точек отсчета).
1.  **EDA (Разведочный анализ):** Выявил проблему "Длинного хвоста" (Long Tail) — популярные книги (Гарри Поттер, Голодные игры) получают львиную долю оценок, создавая смещение (Popularity Bias).
2.  **Бейзлайны:**
    *   *Popularity Model:* Рекомендует хиты. Хороша для холодных пользователей, но не персонализирована.
    *   *Content-Based (TF-IDF):* Решает проблему поиска похожих (Сиквелы, "книги той же серии"), но страдает от отсутствия новизны (рекомендует одно и то же).
3.  **Коллаборативная фильтрация (SVD):** Использована библиотека `Surprise`.
    *   *Проблема:* Высокая разреженность матрицы (99.8%) привела к низким метрикам точности (Precision@10 ~ 0.14). Модель плохо справлялась с "теплыми" пользователями без большой истории.

### Часть 2: Гибридная система и Deep Learning (HW2)
*Файл: `notebooks/02_Hybrid_Neural_System.ipynb`*

**Логика улучшения:**
Чтобы преодолеть ограничения SVD (линейность) и Content-Based (пузырь фильтров), была разработана архитектура, объединяющая подходы.

1.  **Feature Engineering:**
    *   Сгенерированы глобальные признаки: средний рейтинг пользователя, активность, популярность книги. Эти данные используются для обогащения контекста.
    *   Реализован строгий `train_test_split` (80/20) по пользователям для честной валидации всех моделей.

2.  **Нейросетевая модель (NCF - Neural Collaborative Filtering):**
    *   Использован фреймворк **TensorFlow/Keras**.
    *   Архитектура включает Embedding-слои для пользователей и книг, объединенные через конкатенацию с полносвязными (Dense) слоями.
    *   *Преимущество:* Нейросеть способна улавливать нелинейные взаимодействия между пользователем и книгой, которые пропускает обычный SVD.

3.  **Гибридная система (Ensemble):**
    *   Реализован класс `HybridRecommender`, объединяющий предсказания трех агентов взвешенным голосованием:
        *   **SVD (40%)**: Отвечает за общую коллаборативную фильтрацию.
        *   **NCF (40%)**: Улучшает ранжирование за счет глубокого обучения.
        *   **Popularity (20%)**: Страхует систему от грубых ошибок и проблем холодного старта.

### Результаты и Метрики

Оценка проводилась на отложенной тестовой выборке (Top-N рекомендации).

| Модель | Precision@10 | Recall@10 | Комментарий |
| :--- | :--- | :--- | :--- |
| **Popularity** | ~0.05 | ~0.08 | Низкая релевантность, рекомендует только бестселлеры. |
| **SVD** | 0.14 | 0.37 | Базовая персонализация, страдает от разреженности. |
| **NCF (Neural)** | 0.15 | 0.38 | Слегка превосходит SVD за счет нелинейности. |
| **Hybrid (Ens)** | **0.17** | **0.41** | **Лучший результат.** Объединяет сильные стороны подходов. |

### Выводы
Использование гибридного подхода позволило увеличить метрики качества на 15-20% по сравнению с одиночным SVD. Нейросеть (NCF) показала себя как мощное дополнение, а добавление популярности стабилизировало выдачу для пользователей с малой историей.

---
**Запуск:**
1. Установите зависимости: `pip install -r requirements.txt`
2. Запустите ноутбуки в папке `notebooks/` последовательно.